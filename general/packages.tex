% !TEX options=--shell-escape
% !TEX options=--enable-write18
% !TEX options=-enable-write18
\documentclass{report} % We use report to allow for chapers etc...
\usepackage{etoolbox}

\usepackage{iftex} % Used for if
\ifLuaTeX
	\usepackage{shellesc}
	\usepackage{polyglossia}
	\setotherlanguage{english}
	\setdefaultlanguage{italian}
	\usepackage{fontspec}
	\usepackage{luacode} % Used to script stuff
	\usepackage{luatex85}
	\usepackage{luaotfload}
	\usepackage{shellesc}
\else
	\usepackage[utf8]{inputenc} % This allows for utf support.
	\usepackage[english, italian]{babel}   % Set up supported languages. Last one is default.
\fi

\usepackage[T1]{fontenc}  % Defines true type fonts

\let\oldtextbf\textbf % This is a backup for options may edit \textbf
\let\oldtextit\textit % This is a backup for options may edit \textit
\let\oldemph\emph % This is a backup for options may edit \emph

\usepackage{silence}
%Disable all warnings issued by latex starting with "You have..."
\WarningFilter{latex}{You have requested package}
\WarningFilter{latex}{There were undefined references}
\WarningFilter{latex}{Size substitutions with differences}
\WarningFilter{latex}{Command}
\WarningFilter{biblatex}{Using fall-back BibTeX(8)}
\WarningFilter{biblatex}{Please (re)run BibTeX on the file(s)}
\WarningFilter{auxhook}{Cannot patch}
\WarningFilter{glossaries}{No \printglossary or \printglossaries found.}

\usepackage{geometry} % More rich support for page layout.
\geometry{
	a4paper,
	total={170mm,250mm},
	left=20mm,
	top=25mm,
}

\usepackage[x11names,table]{xcolor} % To highlight text

\usepackage{emptypage} % When a page is empty, Latex won't generate page number or other page elements.
\usepackage{multicol} % For the possibility of using columns with  \begin{multicols}{n}.
\usepackage[colorlinks=true,urlcolor=blue,pdfpagelabels,hyperindex=false]{hyperref}  % Enable table of contents and links.
\usepackage{microtype} % for automatic micro fitting of characters
\usepackage{amsmath,amsthm,amsfonts,amssymb}
\usepackage{centernot}

\usepackage{framed}
\usepackage{mathtools}
\usepackage{float} % to enable floating graphics
\usepackage[style=authoryear,sorting=ynt, backend=bibtex]{biblatex} % Package to handle the bibliography
\nocite{*} % This allows for having entried in the bib file that do not have to be necesseraly used
\usepackage{subfiles} % To use subfiles without cruxifying saints
\usepackage{chngcntr} % Has functions to reset counters

\usepackage{parskip} % To leave spaces in paragraphs
\usepackage{bm} % To have bold vectors
\usepackage{soul} % To cancel text with a line using the commant \st, to underline text and highlight.

\usepackage{sectsty}

\usepackage{xfrac} % To allow for sideways fractions
\usepackage[cache=true]{minted} % For highlighting code
\usepackage[algoruled,linesnumbered,titlenumbered,vlined]{\main/../../packages/algorithm2e} % To highlight pseudocode
\definecolor{mintedbackground}{rgb}{0.95,0.95,0.95}
\setminted{
	bgcolor=mintedbackground,
	fontfamily=tt,
	linenos=true,
	numberblanklines=true,
	numbersep=5pt,
	gobble=0,
	frame=leftline,
	framerule=0.4pt,
	framesep=2mm,
	funcnamehighlighting=true,
	tabsize=4,
	obeytabs=false,
	mathescape=false
	samepage=false, %with this setting you can force the list to appear on the same page
	showspaces=false,
	showtabs =false,
	texcl=false,
}

% CDQUOTES HAS TO BE LOADED AFTER THE MINTED
\usepackage{csquotes} % Package required by babel AND polyglossia.

%%%%%%%%%%%%%%%%%%%%%%%%%
% GRAPHICAL EXTRAVAGANZA %
%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{pgfplots} % to draw 3d graphs
\pgfplotsset{compat=1.14}
\usepackage{tikz}
\usepackage{relsize}
\usepackage{circuitikz}

\ctikzset{tripoles/mos style/arrows}
\ctikzset{tripoles/pmos style/emptycircle}
\ctikzset{tripoles/mos style/arrows}
\usetikzlibrary{shapes,arrows,calc,positioning,automata}
\usepgfplotslibrary{external}

\definecolor {processblue}{cmyk}{0.96,0,0,0}
\def\checkmark{\tikz\fill[scale=0.4](0,.35) -- (.25,0) -- (1,.7) -- (.25,.15) -- cycle;}

\pgfmathdeclarefunction{gauss}{3}{%
	\pgfmathparse{1/(#3*sqrt(2*pi))*exp(-((#1-#2)^2)/(2*#3^2))}%
}

\usepackage{paralist} % For compacted enumerations
\usepackage[automake,style=long,nonumberlist,toc,acronym,nomain]{glossaries} % for glossaries and acronyms
\makeglossaries % Enables the package above

\usepackage{imakeidx} % instead of makeidx, so you don't need to run MakeIndex
\makeindex[program=makeindex,columns=2,intoc=true,options={-s ../../general/pyro.ist}] % Enables the package above
\indexsetup{firstpagestyle=empty, othercode=\small} % No page number in the first page of analytical index

\usepackage{bookmark} % Enables bookmarks in generated pdf

\usepackage{fourier} % For icons such as \bomb, \noway, \danger and various others. For more info, go here: http://ctan.mirror.garr.it/mirrors/CTAN/fonts/fourier-GUT/doc/latex/fourier/fourier-orns.pdf

\usepackage{mathtools} % To use custom delimiters that Latex did not implement cos duh
\renewcommand*{\arraystretch}{1.5} % Stretching arrays

\usepackage{fancyhdr} % This allows for the headings in the chapters
\pagestyle{fancy} % This activates it

\usepackage[avantgarde]{quotchap} % Custom style for chapters

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% ALL THE PACKAGES FOR FIGURES   %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{\main/../../general/figures/packages_for_figures.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclarePairedDelimiter\abs{\lvert}{\rvert}
\DeclarePairedDelimiter\norm{\lVert}{\rVert}

\usepackage{enumitem} % For a todo check list
\newlist{todolist}{itemize}{2} % For a  todo check list
\setlist{nolistsep}
\setlist[todolist]{label=$\square$}  % For a todo check list

\counterwithin*{equation}{section}% Reset equation at \section
\counterwithin*{equation}{subsection}% Reset equation at \subsection
%\counterwithin*{equation}{subsubsection}% Reset equation at \subsubsection // Doesn't work for god knows why.

%%%%%%%%%%%%%%%%%%%%%%%%%
% IMPORTANT NOTE ON BIBLIOGRAPHY USE %
%%%%%%%%%%%%%%%%%%%%%%%%%

% To use the bibliography, run BibTex on this file. If everything is correct, it will terminate with no errors.
% The warning "Using fall-back BibTeX(8) backend: (biblatex) functionality may be reduced/unavailable." is expected.

%%%%%%%%%%%%%%%%%%%%%%%%%
% LUATEX CODE %
%%%%%%%%%%%%%%%%%%%%%%%%%

\ifLuaTeX
	\input{\main/../../general/lua/deapnessGuesser.tex}
	\providecommand{\samples}{80} % Drawing hd graphs when compiling for the final time (production)
	\directlua{dofile(deapness.."/general/lua/metadataLoader.lua")}
	\directlua{dofile(deapness.."/general/lua/languageSwitch.lua")}
	\directlua{dofile(deapness.."/general/lua/highlight.lua")}

	% THE FOLLOWING IS AN EXAMPLE ON HOW TO DEFINE A LUA COMMAND
	% \def\command{\directlua{dofile(deapness.."/general/lua/fileName.lua")}}
	% \command
\else
	% Lua not enabled
	\providecommand{\samples}{50} % Drawing ld graphs when compiling for development
	\input{\main/../../general/italian.tex}
\fi

%%%%%%%%%%%%%%%%%%%%%%%%%
% EXTERNAL FILES %
%%%%%%%%%%%%%%%%%%%%%%%%%

\input{\main/../../general/custom_math_commands.tex}
\input{\main/../../general/acronyms.tex}
\addbibresource{references.bib}

\tikzexternalize
